# UnifiedWeb3Platform æµ‹è¯•å’Œéƒ¨ç½²æŒ‡å—

**ç”Ÿæˆæ—¶é—´**: 2025-11-12  
**é¡¹ç›®çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ 93.75%ï¼Œå¯è¿›å…¥æµ‹è¯•å’Œéƒ¨ç½²é˜¶æ®µ

---

## ğŸ“‹ ç›®å½•

1. [æµ‹è¯•æ¸…å•](#æµ‹è¯•æ¸…å•)
2. [æœ¬åœ°æµ‹è¯•](#æœ¬åœ°æµ‹è¯•)
3. [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
4. [éƒ¨ç½²æ­¥éª¤](#éƒ¨ç½²æ­¥éª¤)
5. [æµ‹è¯•è„šæœ¬](#æµ‹è¯•è„šæœ¬)
6. [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)

---

## ä¸€ã€æµ‹è¯•æ¸…å•

### âœ… åŠŸèƒ½æµ‹è¯•æ¸…å•

#### 1. åç«¯ API æµ‹è¯•
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•
- [ ] å•†å“åˆ†ç±» API (`GET /api/store/categories`)
- [ ] å•†å“åˆ—è¡¨ API (`GET /api/store/products`)
- [ ] å•†å“æœç´¢ API (å…³é”®è¯ã€ä»·æ ¼ã€é“¾IDç­›é€‰)
- [ ] å•†å“è¯¦æƒ… API (`GET /api/store/products/{id}`)
- [ ] å•†å“å›¾ç‰‡ API (`GET /api/store/products/{id}/images`)
- [ ] å•†å“è§„æ ¼ API (`GET /api/store/products/{id}/specifications`)
- [ ] å•†å“è¯„ä»· API (`GET /api/store/products/{id}/reviews`)
- [ ] è´­ç‰©è½¦ API (å¢åˆ æ”¹æŸ¥)
- [ ] è®¢å•åˆ›å»º API (`POST /api/orders`)
- [ ] è®¢å•åˆ—è¡¨ API (`GET /api/orders`)
- [ ] è®¢å•è¯¦æƒ… API (`GET /api/orders/{id}`)
- [ ] Web3 æ”¯ä»˜å‡†å¤‡ API (`POST /api/orders/{id}/prepare-payment`)
- [ ] æ”¯ä»˜çŠ¶æ€æŸ¥è¯¢ API (`GET /api/orders/{id}/payment-status`)
- [ ] è®¢å•å–æ¶ˆ API (`POST /api/orders/{id}/cancel`)

#### 2. å‰ç«¯åŠŸèƒ½æµ‹è¯•
- [ ] é¡µé¢åŠ è½½å’Œè·¯ç”±
- [ ] é’±åŒ…è¿æ¥ï¼ˆBitget Wallet / MetaMaskï¼‰
- [ ] å•†å“åˆ—è¡¨å±•ç¤º
- [ ] å•†å“æœç´¢å’Œç­›é€‰
- [ ] å•†å“è¯¦æƒ…é¡µ
- [ ] è´­ç‰©è½¦åŠŸèƒ½
- [ ] è®¢å•åˆ›å»ºæµç¨‹
- [ ] Web3 æ”¯ä»˜æµç¨‹
- [ ] è®¢å•åˆ—è¡¨å’Œè¯¦æƒ…
- [ ] è®¢å•çŠ¶æ€æµè½¬
- [ ] æ™ºèƒ½è½®è¯¢æœºåˆ¶

#### 3. Web3 åŠŸèƒ½æµ‹è¯•
- [ ] é’±åŒ…è¿æ¥
- [ ] é“¾åˆ‡æ¢
- [ ] æ”¯ä»˜ç­¾å
- [ ] é“¾ä¸Šäº¤æ˜“éªŒè¯
- [ ] æ”¯ä»˜çŠ¶æ€è½®è¯¢

#### 4. æ•°æ®åº“æµ‹è¯•
- [ ] æ•°æ®åº“è¿æ¥
- [ ] è¿ç§»æ–‡ä»¶æ‰§è¡Œ
- [ ] è¡¨ç»“æ„å®Œæ•´æ€§
- [ ] æ•°æ®æ’å…¥/æŸ¥è¯¢

---

## äºŒã€æœ¬åœ°æµ‹è¯•

### 2.1 ç¯å¢ƒå‡†å¤‡

#### æ£€æŸ¥æ¸…å•
```powershell
# 1. æ£€æŸ¥ .NET SDK
dotnet --version  # åº”è¯¥ >= 8.0

# 2. æ£€æŸ¥ Node.js
node --version    # åº”è¯¥ >= 18.0

# 3. æ£€æŸ¥ SQL Server
# æ£€æŸ¥ LocalDB æˆ– SQL Server Express æ˜¯å¦è¿è¡Œ
```

#### æ•°æ®åº“é…ç½®
1. ç¡®è®¤ `appsettings.json` ä¸­çš„è¿æ¥å­—ç¬¦ä¸²æ­£ç¡®
2. ç¡®è®¤æ•°æ®åº“å·²åˆ›å»º
3. ç¡®è®¤è¿ç§»å·²æ‰§è¡Œ

### 2.2 å¯åŠ¨åç«¯æœåŠ¡

```powershell
# æ–¹å¼1: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬
cd "D:\claude code\plg\UnifiedWeb3Platform"
.\run_backend.bat

# æ–¹å¼2: æ‰‹åŠ¨å¯åŠ¨
cd src\Backend\UnifiedPlatform.WebApi
dotnet run

# é»˜è®¤åœ°å€: https://localhost:5001 æˆ– http://localhost:5000
```

#### éªŒè¯åç«¯
```powershell
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:5000/api/health

# æµ‹è¯•å•†å“åˆ†ç±»
curl http://localhost:5000/api/store/categories

# æ‰“å¼€ Swagger
# æµè§ˆå™¨è®¿é—®: http://localhost:5000/swagger
```

### 2.3 å¯åŠ¨å‰ç«¯æœåŠ¡

```powershell
# æ–¹å¼1: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬
cd "D:\claude code\plg\UnifiedWeb3Platform"
.\run_frontend.bat

# æ–¹å¼2: æ‰‹åŠ¨å¯åŠ¨
cd src\Frontend\web-app
npm install  # é¦–æ¬¡è¿è¡Œéœ€è¦
npm run dev

# é»˜è®¤åœ°å€: http://localhost:5173
```

#### éªŒè¯å‰ç«¯
1. æµè§ˆå™¨è®¿é—®: `http://localhost:5173`
2. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
3. æµ‹è¯•é’±åŒ…è¿æ¥åŠŸèƒ½

### 2.4 åŠŸèƒ½æµ‹è¯•æµç¨‹

#### æµ‹è¯•æµç¨‹ 1: å•†å“æµè§ˆ
1. æ‰“å¼€é¦–é¡µ
2. æŸ¥çœ‹å•†å“åˆ—è¡¨
3. ä½¿ç”¨æœç´¢åŠŸèƒ½
4. ä½¿ç”¨ç­›é€‰åŠŸèƒ½ï¼ˆä»·æ ¼ã€é“¾IDï¼‰
5. æŸ¥çœ‹å•†å“è¯¦æƒ…

#### æµ‹è¯•æµç¨‹ 2: è´­ç‰©æµç¨‹
1. è¿æ¥é’±åŒ…
2. æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
3. æŸ¥çœ‹è´­ç‰©è½¦
4. åˆ›å»ºè®¢å•
5. å®Œæˆæ”¯ä»˜ï¼ˆWeb3 æ”¯ä»˜ï¼‰

#### æµ‹è¯•æµç¨‹ 3: è®¢å•ç®¡ç†
1. æŸ¥çœ‹è®¢å•åˆ—è¡¨
2. æŸ¥çœ‹è®¢å•è¯¦æƒ…
3. æµ‹è¯•è®¢å•å–æ¶ˆ
4. éªŒè¯æ”¯ä»˜çŠ¶æ€æ›´æ–°

---

## ä¸‰ã€éƒ¨ç½²æ–¹æ¡ˆ

### 3.1 æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | æˆæœ¬ | é€‚ç”¨åœºæ™¯ | æ¨èåº¦ |
|------|------|----------|--------|
| **Cloudflare Tunnel** | å…è´¹ | å¿«é€Ÿæµ‹è¯•ã€æ¼”ç¤º | â­â­â­â­â­ |
| **Cloudflare Pages + Tunnel** | å…è´¹ | ç”Ÿäº§ç¯å¢ƒï¼ˆå°è§„æ¨¡ï¼‰ | â­â­â­â­ |
| **äº‘æœåŠ¡å™¨ + Nginx** | Â¥200-500/æœˆ | ç”Ÿäº§ç¯å¢ƒï¼ˆå¤§è§„æ¨¡ï¼‰ | â­â­â­ |

### 3.2 æ¨èæ–¹æ¡ˆï¼šCloudflare Tunnelï¼ˆå½“å‰æ–¹æ¡ˆï¼‰

**ä¼˜åŠ¿**:
- âœ… å®Œå…¨å…è´¹
- âœ… æ— éœ€å…¬ç½‘ IP
- âœ… è‡ªåŠ¨ HTTPS
- âœ… é…ç½®ç®€å•

**æ¶æ„**:
```
å‰ç«¯: Cloudflare Pages (https://www.a292428dsj.dpdns.org)
åç«¯: Cloudflare Tunnel (https://api.a292428dsj.dpdns.org)
æ•°æ®åº“: æœ¬åœ° SQL Server
```

---

## å››ã€éƒ¨ç½²æ­¥éª¤

### 4.1 éƒ¨ç½²å‰ç«¯åˆ° Cloudflare Pages

#### æ­¥éª¤ 1: æ„å»ºå‰ç«¯
```powershell
cd src\Frontend\web-app
npm run build
# è¾“å‡ºç›®å½•: dist/
```

#### æ­¥éª¤ 2: é…ç½®ç¯å¢ƒå˜é‡
åˆ›å»º `.env.production`:
```env
VITE_API_BASE_URL=https://api.a292428dsj.dpdns.org
```

#### æ­¥éª¤ 3: éƒ¨ç½²åˆ° Cloudflare Pages
1. ç™»å½• Cloudflare Dashboard
2. è¿›å…¥ Pages æœåŠ¡
3. åˆ›å»ºæ–°é¡¹ç›®æˆ–æ›´æ–°ç°æœ‰é¡¹ç›®
4. ä¸Šä¼  `dist/` ç›®å½•æˆ–è¿æ¥ Git ä»“åº“

### 4.2 éƒ¨ç½²åç«¯ï¼ˆCloudflare Tunnelï¼‰

#### æ­¥éª¤ 1: å®‰è£… Cloudflared
```powershell
# ä¸‹è½½ cloudflared
# https://github.com/cloudflare/cloudflared/releases
# æˆ–ä½¿ç”¨ Chocolatey
choco install cloudflared
```

#### æ­¥éª¤ 2: ç™»å½• Cloudflare
```powershell
cloudflared tunnel login
```

#### æ­¥éª¤ 3: åˆ›å»º Tunnel
```powershell
cloudflared tunnel create unifiedweb3-api
```

#### æ­¥éª¤ 4: é…ç½®è·¯ç”±
åœ¨ Cloudflare Dashboard ä¸­é…ç½®ï¼š
- ä¸»æœºå: `api.a292428dsj.dpdns.org`
- æœåŠ¡: `http://localhost:5000`

#### æ­¥éª¤ 5: è¿è¡Œ Tunnel
```powershell
# æ–¹å¼1: ä½¿ç”¨é…ç½®æ–‡ä»¶
cloudflared tunnel run unifiedweb3-api

# æ–¹å¼2: ä½¿ç”¨å‘½ä»¤ï¼ˆä¸´æ—¶ï¼‰
cloudflared tunnel --url http://localhost:5000
```

#### æ­¥éª¤ 6: é…ç½®ä¸º Windows æœåŠ¡ï¼ˆå¯é€‰ï¼‰
```powershell
# å®‰è£…ä¸ºæœåŠ¡
cloudflared service install
```

### 4.3 é…ç½® CORS

ç¡®ä¿ `Program.cs` ä¸­çš„ CORS é…ç½®åŒ…å«å‰ç«¯åŸŸåï¼š
```csharp
builder.Services.AddCors(options =>
{
    options.AddPolicy("DefaultCors", policy =>
    {
        policy
            .WithOrigins(
                "https://www.a292428dsj.dpdns.org",
                "https://a292428dsj.dpdns.org",
                "https://unified-web3-platform.pages.dev"
            )
            .AllowAnyHeader()
            .AllowAnyMethod();
    });
});
```

### 4.4 æ•°æ®åº“è¿ç§»

#### ç”Ÿäº§ç¯å¢ƒè¿ç§»
```powershell
cd src\Backend\UnifiedPlatform.DbService
dotnet ef database update --context StDbContext
```

---

## äº”ã€æµ‹è¯•è„šæœ¬

### 5.1 API æµ‹è¯•è„šæœ¬

åˆ›å»º `test_api.ps1`:
```powershell
$baseUrl = "http://localhost:5000"

Write-Host "Testing API endpoints..." -ForegroundColor Cyan

# æµ‹è¯•å•†å“åˆ†ç±»
Write-Host "`n[1] Testing categories..." -ForegroundColor Yellow
$response = Invoke-RestMethod -Uri "$baseUrl/api/store/categories" -Method Get
Write-Host "  Categories count: $($response.data.Count)" -ForegroundColor Green

# æµ‹è¯•å•†å“åˆ—è¡¨
Write-Host "`n[2] Testing products..." -ForegroundColor Yellow
$response = Invoke-RestMethod -Uri "$baseUrl/api/store/products?page=1&pageSize=5" -Method Get
Write-Host "  Products count: $($response.data.items.Count)" -ForegroundColor Green

# æµ‹è¯•å•†å“è¯¦æƒ…
if ($response.data.items.Count -gt 0) {
    $productId = $response.data.items[0].productId
    Write-Host "`n[3] Testing product detail ($productId)..." -ForegroundColor Yellow
    $response = Invoke-RestMethod -Uri "$baseUrl/api/store/products/$productId" -Method Get
    Write-Host "  Product name: $($response.data.name)" -ForegroundColor Green
}

Write-Host "`nAPI tests completed!" -ForegroundColor Green
```

### 5.2 æ•°æ®åº“æµ‹è¯•è„šæœ¬

åˆ›å»º `test_database.ps1`:
```powershell
Write-Host "Testing database connection..." -ForegroundColor Cyan

# æ£€æŸ¥è¿ç§»çŠ¶æ€
cd src\Backend\UnifiedPlatform.DbService
dotnet ef migrations list --context StDbContext

Write-Host "`nDatabase test completed!" -ForegroundColor Green
```

---

## å…­ã€æ•…éšœæ’æŸ¥

### 6.1 å¸¸è§é—®é¢˜

#### é—®é¢˜ 1: åç«¯æ— æ³•å¯åŠ¨
**ç—‡çŠ¶**: `dotnet run` æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
2. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
3. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´

#### é—®é¢˜ 2: å‰ç«¯æ— æ³•è¿æ¥åç«¯
**ç—‡çŠ¶**: æ§åˆ¶å°æ˜¾ç¤º CORS é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `Program.cs` ä¸­çš„ CORS é…ç½®
2. ç¡®è®¤å‰ç«¯ API Base URL é…ç½®æ­£ç¡®
3. æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œ

#### é—®é¢˜ 3: æ•°æ®åº“è¿æ¥å¤±è´¥
**ç—‡çŠ¶**: å¯åŠ¨æ—¶æç¤ºæ•°æ®åº“è¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ SQL Server æ˜¯å¦è¿è¡Œ
2. æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨
4. æ‰§è¡Œæ•°æ®åº“è¿ç§»

#### é—®é¢˜ 4: Cloudflare Tunnel è¿æ¥å¤±è´¥
**ç—‡çŠ¶**: Tunnel æ— æ³•è¿æ¥åˆ°æœ¬åœ°æœåŠ¡

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ Tunnel é…ç½®ä¸­çš„ URL
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. æŸ¥çœ‹ Tunnel æ—¥å¿—

### 6.2 æ—¥å¿—æŸ¥çœ‹

#### åç«¯æ—¥å¿—
```powershell
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
# æ—¥å¿—ä½ç½®: æ§åˆ¶å°è¾“å‡ºæˆ–æ—¥å¿—æ–‡ä»¶
```

#### å‰ç«¯æ—¥å¿—
```powershell
# æµè§ˆå™¨æ§åˆ¶å° (F12)
# æŸ¥çœ‹ Network æ ‡ç­¾é¡µæ£€æŸ¥ API è¯·æ±‚
```

#### Cloudflare Tunnel æ—¥å¿—
```powershell
# Tunnel è¿è¡Œæ—¶ä¼šè¾“å‡ºæ—¥å¿—
# æ£€æŸ¥è¿æ¥çŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯
```

---

## ä¸ƒã€éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] æ•°æ®åº“å·²åˆ›å»ºå¹¶è¿ç§»
- [ ] åç«¯æœåŠ¡å¯æ­£å¸¸å¯åŠ¨
- [ ] å‰ç«¯å¯æ­£å¸¸æ„å»º
- [ ] API æµ‹è¯•é€šè¿‡
- [ ] CORS é…ç½®æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

### éƒ¨ç½²åæ£€æŸ¥
- [ ] å‰ç«¯å¯æ­£å¸¸è®¿é—®
- [ ] åç«¯ API å¯æ­£å¸¸è®¿é—®
- [ ] é’±åŒ…è¿æ¥åŠŸèƒ½æ­£å¸¸
- [ ] å•†å“åˆ—è¡¨å¯æ­£å¸¸åŠ è½½
- [ ] è®¢å•åˆ›å»ºæµç¨‹æ­£å¸¸
- [ ] Web3 æ”¯ä»˜æµç¨‹æ­£å¸¸

---

## å…«ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 8.1 åç«¯ä¼˜åŒ–
- å¯ç”¨å“åº”å‹ç¼©
- é…ç½®ç¼“å­˜ç­–ç•¥
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
- æ·»åŠ æ•°æ®åº“ç´¢å¼•

### 8.2 å‰ç«¯ä¼˜åŒ–
- å¯ç”¨ä»£ç åˆ†å‰²
- é…ç½® CDN
- ä¼˜åŒ–å›¾ç‰‡åŠ è½½
- å¯ç”¨æµè§ˆå™¨ç¼“å­˜

---

## ä¹ã€å®‰å…¨å»ºè®®

### 9.1 ç”Ÿäº§ç¯å¢ƒé…ç½®
- [ ] ä½¿ç”¨å¼ºå¯†ç 
- [ ] å¯ç”¨ HTTPS
- [ ] é…ç½®é˜²ç«å¢™
- [ ] é™åˆ¶ API è®¿é—®é¢‘ç‡
- [ ] å¯ç”¨æ—¥å¿—è®°å½•

### 9.2 æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
- [ ] ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
- [ ] ä¸è¦æäº¤æ•æ„Ÿä¿¡æ¯åˆ° Git
- [ ] å®šæœŸæ›´æ–°ä¾èµ–åŒ…

---

## åã€åç»­ç»´æŠ¤

### 10.1 ç›‘æ§
- ç›‘æ§æœåŠ¡è¿è¡ŒçŠ¶æ€
- ç›‘æ§ API å“åº”æ—¶é—´
- ç›‘æ§é”™è¯¯æ—¥å¿—

### 10.2 æ›´æ–°
- å®šæœŸæ›´æ–°ä¾èµ–åŒ…
- å®šæœŸå¤‡ä»½æ•°æ®åº“
- å®šæœŸæ£€æŸ¥å®‰å…¨æ›´æ–°

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-12

