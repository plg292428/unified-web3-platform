# 环境变量配置说明

## 为什么使用环境变量？

在生产环境中，敏感信息（如密码、密钥）不应直接存储在配置文件中，而应使用环境变量。

## 配置方法

### Windows 环境变量

#### 设置环境变量
```powershell
# 设置数据库密码
[Environment]::SetEnvironmentVariable("DB_PASSWORD", "YourSecurePassword", "Machine")

# 设置 JWT 密钥
[Environment]::SetEnvironmentVariable("JWT_SECURITY_KEY", "YourSecureKey", "Machine")

# 设置 TRON API 密钥
[Environment]::SetEnvironmentVariable("TRON_API_KEY", "YourApiKey", "Machine")
```

#### 在 appsettings.json 中使用
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Database=UnifiedWeb3Platform;User Id=sa;Password=%DB_PASSWORD%;TrustServerCertificate=True;"
  },
  "JwtSettings": {
    "SecurityKey": "%JWT_SECURITY_KEY%"
  }
}
```

### .NET Core 环境变量支持

在 `Program.cs` 中，可以使用：
```csharp
var dbPassword = Environment.GetEnvironmentVariable("DB_PASSWORD");
var jwtKey = Environment.GetEnvironmentVariable("JWT_SECURITY_KEY");
```

### 使用 User Secrets（开发环境）

```bash
cd src/Backend/UnifiedPlatform.WebApi
dotnet user-secrets init
dotnet user-secrets set "ConnectionStrings:DefaultConnection:Password" "YourPassword"
dotnet user-secrets set "JwtSettings:SecurityKey" "YourKey"
```

## 推荐的配置方式

### 开发环境
- 使用 `appsettings.json` 或 User Secrets

### 生产环境
- 使用环境变量
- 或使用密钥管理服务（如 Azure Key Vault, AWS Secrets Manager）

## 安全最佳实践

1. **不要提交敏感信息到 Git**
   - 使用 `.gitignore` 排除包含密码的文件
   - 使用 `.env.example` 作为模板

2. **使用强密码和密钥**
   - 密码至少 16 字符，包含大小写字母、数字、特殊字符
   - JWT 密钥至少 32 字符，使用随机生成

3. **定期轮换密钥**
   - 定期更新数据库密码
   - 定期更新 JWT 密钥（需要通知所有客户端）

4. **使用不同的密钥**
   - 开发、测试、生产环境使用不同的密钥
   - 不同服务使用不同的密钥


