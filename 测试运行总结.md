# 项目测试运行总结

## ✅ 准备状态

### 编译状态
- ✅ **编译成功** - 0个错误，0个警告
- ✅ **所有依赖** - 已正确引用
- ✅ **配置文件** - 已正确配置

### 配置状态
- ✅ **数据库连接** - 已配置为SmallTarget数据库
- ✅ **JWT设置** - 已配置
- ✅ **所有服务** - 已正确注册

## 🚀 运行项目

### 快速启动

**方法1：使用脚本（推荐）**
```powershell
cd "D:\claude code\plg\UnifiedWeb3Platform"
.\run_backend.bat
```

**方法2：手动运行**
```powershell
cd "D:\claude code\plg\UnifiedWeb3Platform\src\Backend\UnifiedPlatform.WebApi"
dotnet run
```

## 📍 访问地址

项目启动后（通常需要5-10秒），访问以下地址：

| 服务 | 地址 | 说明 |
|------|------|------|
| **Swagger UI** | `https://localhost:7266/swagger` | API文档和测试界面 |
| **健康检查** | `https://localhost:7266/health` | 服务健康状态 |
| **HTTPS API** | `https://localhost:7266` | HTTPS端点 |
| **HTTP API** | `http://localhost:5195` | HTTP端点 |

## 🧪 测试步骤

### 1. 启动项目

运行 `.\run_backend.bat`，等待看到：
```
Now listening on: https://localhost:7266
Now listening on: http://localhost:5195
Application started. Press Ctrl+C to shut down.
```

### 2. 测试健康检查

在浏览器中访问：
```
https://localhost:7266/health
```

**预期响应：**
```json
{
  "status": "healthy",
  "timestamp": "2025-01-27T..."
}
```

### 3. 访问Swagger UI

在浏览器中访问：
```
https://localhost:7266/swagger
```

**应该看到：**
- API端点列表
- 可以测试各个端点
- 查看API文档

### 4. 测试数据库连接

在Swagger UI中测试需要数据库的API端点，验证：
- 数据库连接是否正常
- 数据查询是否成功
- API功能是否正常

## ⚠️ 常见问题

### 问题1：数据库连接失败

**症状：**
```
Cannot open database "SmallTarget"
SqlException: Cannot open database
```

**解决方案：**
1. 检查数据库是否存在：
   ```powershell
   sqlcmd -S "(localdb)\MSSQLLocalDB" -Q "SELECT name FROM sys.databases WHERE name = 'SmallTarget'"
   ```

2. 如果不存在，需要：
   - 使用原有SmallTarget项目创建数据库
   - 或修改连接字符串指向其他数据库

### 问题2：端口被占用

**症状：**
```
Failed to bind to address https://localhost:7266
```

**解决方案：**
1. 关闭占用端口的程序
2. 或修改 `Properties/launchSettings.json` 中的端口号

### 问题3：HTTPS证书警告

**症状：**
浏览器显示"不安全连接"警告

**解决方案：**
- 开发环境可以忽略此警告
- 点击"高级" → "继续访问（不安全）"

### 问题4：服务启动缓慢

**症状：**
启动时间超过30秒

**可能原因：**
- 首次运行需要加载大量依赖
- 数据库连接尝试超时
- 检查日志查看具体原因

## 📋 成功标志

### 启动成功标志

1. **控制台输出：**
   ```
   Now listening on: https://localhost:7266
   Now listening on: http://localhost:5195
   Application started.
   ```

2. **健康检查响应：**
   - 返回200状态码
   - 返回JSON格式的健康状态

3. **Swagger UI：**
   - 可以正常访问
   - 显示所有API端点
   - 可以展开和测试端点

## 🎯 测试检查清单

启动项目后，验证：

- [ ] 项目成功启动，无致命错误
- [ ] 控制台显示监听地址
- [ ] 健康检查端点返回成功
- [ ] Swagger UI可以访问
- [ ] API端点列表显示正常
- [ ] 数据库连接正常（测试需要数据库的端点）

## 📝 下一步操作

### 如果测试成功

1. **继续开发**
   - 添加新的API端点
   - 实现业务逻辑
   - 集成前端功能

2. **启动前端**
   ```powershell
   .\run_frontend.bat
   ```

3. **完整测试**
   - 测试前后端集成
   - 验证完整业务流程

### 如果遇到问题

1. **查看日志**
   - 检查控制台输出的错误信息
   - 查看详细的异常堆栈

2. **检查配置**
   - 验证连接字符串
   - 检查数据库是否存在
   - 确认端口是否可用

3. **参考文档**
   - `database_setup_guide.md` - 数据库配置指南
   - `README.md` - 项目说明文档

## ✅ 测试准备完成

**项目已准备就绪，可以开始测试运行！**

运行命令：
```powershell
.\run_backend.bat
```

然后访问 `https://localhost:7266/swagger` 查看API文档。

